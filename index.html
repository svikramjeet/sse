<!DOCTYPE html>
<html>
  <body>
    <h1>Getting server updates</h1>
    <div id="result"></div>

    <script>
      if (typeof EventSource !== "undefined") {
        const evtSource = new EventSource("sse.php");
        evtSource.onmessage = function(event) {
          const newElement = document.createElement("li");
          const eventList = document.getElementById("list");

          newElement.innerHTML = "message: " + event.data;
          eventList.appendChild(newElement);
        }

        evtSource.onerror = function(err) {
          console.error("EventSource failed:", err);
        };

        evtSource.addEventListener("ping", function(event) {
        const newElement = document.createElement("li");
        const time = JSON.parse(event.data).time;
        newElement.innerHTML = "ping at " + time;
        eventList.appendChild(newElement);
        });


      } else {
        document.getElementById("result").innerHTML =
          "Sorry, your browser does not support server-sent events...";
      }
    </script>
  </body>
</html>